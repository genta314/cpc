---
title: PleromaにNowplayingする
date: 2021-02-21
tags:
 - Web
---
タイトルだけだと何を言っているのよく分からない感じになっているけれど、現在私はPleromaを使っていてiPadではクライアントは使っていなくてwebから使っている。Front-endはsoapbox-feを使っているのだけれど、まぁまぁ使い易いかなって感じではあるよね。キーボードショートカットが効かないのがあるけれど、それ程困っていないのでまぁ良いかで使っているよね。

で、Front-endの話はさて置き、音楽を聴いていると時々nowplayingのtootをやりたくなるのだけれど、これがクライアントを使ってもなんか好みじゃないのかなっていうので、簡単に作成出来る方法を思いついたのでやってみたら成功したよね。

私は、iPadでApple Musicを使っているのでiOSとApple Music専用だよ。

まず、shortcutsを使って目的の動作を行うようにするのだけれど、フルスクラッチで作る必要はなくて、shortcutsのデフォルトに入っている"Apple Musicのリンクをコピー"というショートカットがあるのでそれをコピーして改造って手順だよね。

Pleroma側の準備としては、Access Tokenを準備しないといけないのだけれど、これがどこから取得するのか分からなかったけれど、[このサイト](https://tools.splat.soy/pleroma-access-token/)で発行するしかないようなので必要事項入力して発行しましょう。Access Tokenは、後で使うのでメモって終了ですね。

で、最初のコピーしてきたショートカットを開いてみると最後にテキストをクリップボードにコピーとなっているので、一つ前のテキストを適宜編集しておく。この内容がtootの内容になります。

追加アクションで"URL"を選んでurlに`https://Youre.Site/api/v1/statuses`というurlを入力する。この辺りの話は、Pleromaのapi documentを見たりすると色々あったりするよね。
次に"URLの内容を取得"というアクションを選んで次のように入力する。
```
方法 : POST
ヘッダ :
authorization Bearer(半角スペース)Access Token
本文を要求 : JSON
status クリップボード
```
authorizationの項目でBearerってあるけれど、Pleromaでどうやってauthorizeしているのかと調べてもなんか分からんってなったのでMastodonと同じやり方でどうかなってやってみたら成功したので、そのまま使っているよね。正解は誰か教えて欲しいですね。

これでショートカットを動作させると今聴いている曲のタイトルとかがPleromaにtootされるので、適当にnowplayingやっていきましょう。
